import { f as createComponent, k as renderComponent, r as renderTemplate, l as defineScriptVars, m as maybeRenderHead } from '../chunks/astro/server_DXpmQ0xB.mjs';
import { $ as $$AdminLayout } from '../chunks/AdminLayout_BNdV-RCA.mjs';
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const prerender = false;
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const API_BASE = "http://localhost:3000";
  return renderTemplate`${renderComponent($$result, "AdminLayout", $$AdminLayout, { "title": "Dashboard" }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<div> <h1 class="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1> <div id="stats" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Total Posts</div> <div class="text-3xl font-bold text-gray-900" id="totalPosts">-</div> </div> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Published</div> <div class="text-3xl font-bold text-green-600" id="publishedPosts">-</div> </div> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Categories</div> <div class="text-3xl font-bold text-blue-600" id="totalCategories">-</div> </div> </div> <div class="bg-white rounded-lg shadow"> <div class="p-6 border-b border-gray-200"> <h2 class="text-xl font-semibold text-gray-900">Recent Posts</h2> </div> <div id="recentPosts" class="divide-y divide-gray-200"> <div class="p-6 text-gray-500">Loading...</div> </div> </div> </div> <script>(function(){', "\n    (async function(){\n      const getToken = () => {\n        try { const t = localStorage.getItem('token'); if (t) return t; } catch(e) {}\n        const m = document.cookie.match(/(?:^|; )token=([^;]+)/);\n        if (m) return decodeURIComponent(m[1]);\n        return null;\n      };\n\n      const token = getToken();\n      if (!token) return;\n\n      try {\n        // Fetch posts\n        const postsRes = await fetch(`${API_BASE}/admin/posts`, {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        const posts = await postsRes.json();\n\n        // Fetch categories\n        const catsRes = await fetch(`${API_BASE}/admin/categories`, {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        const categories = await catsRes.json();\n\n        // Update stats\n        document.getElementById('totalPosts').textContent = posts.length;\n        document.getElementById('publishedPosts').textContent = posts.filter(p => p.published).length;\n        document.getElementById('totalCategories').textContent = categories.length;\n\n        // Show recent posts\n        const recentPostsEl = document.getElementById('recentPosts');\n        if (posts.length === 0) {\n          recentPostsEl.innerHTML = '<div class=\"p-6 text-gray-500\">No posts yet</div>';\n        } else {\n          recentPostsEl.innerHTML = posts.slice(0, 5).map(post => `\n            <div class=\"p-6 hover:bg-gray-50\">\n              <div class=\"flex items-center justify-between\">\n                <div>\n                  <h3 class=\"font-medium text-gray-900\">${post.title}</h3>\n                  <p class=\"text-sm text-gray-500 mt-1\">\n                    ${new Date(post.created_at).toLocaleDateString()}\n                    ${post.published ? '<span class=\"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded\">Published</span>' : '<span class=\"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded\">Draft</span>'}\n                  </p>\n                </div>\n                <a href=\"/admin/posts/${post.id}\" class=\"text-blue-600 hover:text-blue-800\">Edit</a>\n              </div>\n            </div>\n          `).join('');\n        }\n      } catch (err) {\n        console.error('Failed to load dashboard data', err);\n      }\n    })();\n  })();</script> "], [" ", '<div> <h1 class="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1> <div id="stats" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Total Posts</div> <div class="text-3xl font-bold text-gray-900" id="totalPosts">-</div> </div> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Published</div> <div class="text-3xl font-bold text-green-600" id="publishedPosts">-</div> </div> <div class="bg-white p-6 rounded-lg shadow"> <div class="text-sm text-gray-600 mb-1">Categories</div> <div class="text-3xl font-bold text-blue-600" id="totalCategories">-</div> </div> </div> <div class="bg-white rounded-lg shadow"> <div class="p-6 border-b border-gray-200"> <h2 class="text-xl font-semibold text-gray-900">Recent Posts</h2> </div> <div id="recentPosts" class="divide-y divide-gray-200"> <div class="p-6 text-gray-500">Loading...</div> </div> </div> </div> <script>(function(){', "\n    (async function(){\n      const getToken = () => {\n        try { const t = localStorage.getItem('token'); if (t) return t; } catch(e) {}\n        const m = document.cookie.match(/(?:^|; )token=([^;]+)/);\n        if (m) return decodeURIComponent(m[1]);\n        return null;\n      };\n\n      const token = getToken();\n      if (!token) return;\n\n      try {\n        // Fetch posts\n        const postsRes = await fetch(\\`\\${API_BASE}/admin/posts\\`, {\n          headers: { Authorization: \\`Bearer \\${token}\\` }\n        });\n        const posts = await postsRes.json();\n\n        // Fetch categories\n        const catsRes = await fetch(\\`\\${API_BASE}/admin/categories\\`, {\n          headers: { Authorization: \\`Bearer \\${token}\\` }\n        });\n        const categories = await catsRes.json();\n\n        // Update stats\n        document.getElementById('totalPosts').textContent = posts.length;\n        document.getElementById('publishedPosts').textContent = posts.filter(p => p.published).length;\n        document.getElementById('totalCategories').textContent = categories.length;\n\n        // Show recent posts\n        const recentPostsEl = document.getElementById('recentPosts');\n        if (posts.length === 0) {\n          recentPostsEl.innerHTML = '<div class=\"p-6 text-gray-500\">No posts yet</div>';\n        } else {\n          recentPostsEl.innerHTML = posts.slice(0, 5).map(post => \\`\n            <div class=\"p-6 hover:bg-gray-50\">\n              <div class=\"flex items-center justify-between\">\n                <div>\n                  <h3 class=\"font-medium text-gray-900\">\\${post.title}</h3>\n                  <p class=\"text-sm text-gray-500 mt-1\">\n                    \\${new Date(post.created_at).toLocaleDateString()}\n                    \\${post.published ? '<span class=\"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded\">Published</span>' : '<span class=\"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded\">Draft</span>'}\n                  </p>\n                </div>\n                <a href=\"/admin/posts/\\${post.id}\" class=\"text-blue-600 hover:text-blue-800\">Edit</a>\n              </div>\n            </div>\n          \\`).join('');\n        }\n      } catch (err) {\n        console.error('Failed to load dashboard data', err);\n      }\n    })();\n  })();</script> "])), maybeRenderHead(), defineScriptVars({ API_BASE })) })}`;
}, "/home/dave/Documents/devnewsletter/newsletter/src/pages/admin/index.astro", void 0);
const $$file = "/home/dave/Documents/devnewsletter/newsletter/src/pages/admin/index.astro";
const $$url = "/admin";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
