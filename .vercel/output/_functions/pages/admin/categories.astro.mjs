import { f as createComponent, k as renderComponent, r as renderTemplate, l as defineScriptVars, m as maybeRenderHead } from '../../chunks/astro/server_DXpmQ0xB.mjs';
import { $ as $$AdminLayout } from '../../chunks/AdminLayout_BFt6wXvG.mjs';
export { renderers } from '../../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const prerender = false;
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const API_BASE = "http://localhost:3000";
  return renderTemplate`${renderComponent($$result, "AdminLayout", $$AdminLayout, { "title": "Categories" }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<div> <h1 class="text-3xl font-bold text-gray-900 mb-8">Categories</h1> <!-- Create new category form --> <div class="bg-white rounded-lg shadow p-6 mb-6"> <h2 class="text-lg font-semibold text-gray-900 mb-4">Add New Category</h2> <form id="createForm" class="flex gap-4"> <div class="flex-1"> <input type="text" id="newName" placeholder="Category name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"> </div> <div class="flex-1"> <input type="text" id="newSlug" placeholder="slug-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"> </div> <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">\nAdd Category\n</button> </form> </div> <!-- Categories list --> <div class="bg-white rounded-lg shadow"> <div class="p-6 border-b border-gray-200"> <h2 class="text-lg font-semibold text-gray-900">All Categories</h2> </div> <div id="categoriesTable" class="divide-y divide-gray-200"> <div class="p-6 text-gray-500">Loading...</div> </div> </div> </div> <script>(function(){', "\n    (async function(){\n      const getToken = () => {\n        try { const t = localStorage.getItem('token'); if (t) return t; } catch(e) {}\n        const m = document.cookie.match(/(?:^|; )token=([^;]+)/);\n        if (m) return decodeURIComponent(m[1]);\n        return null;\n      };\n\n      const token = getToken();\n      if (!token) return;\n\n      let categories = [];\n      let editingId = null;\n\n      async function loadCategories() {\n        try {\n          const res = await fetch(`${API_BASE}/admin/categories`, {\n            headers: { Authorization: `Bearer ${token}` }\n          });\n          categories = await res.json();\n          renderCategories();\n        } catch (err) {\n          console.error('Failed to load categories', err);\n          document.getElementById('categoriesTable').innerHTML = '<div class=\"p-6 text-red-500\">Failed to load categories</div>';\n        }\n      }\n\n      function renderCategories() {\n        const table = document.getElementById('categoriesTable');\n        if (categories.length === 0) {\n          table.innerHTML = '<div class=\"p-6 text-gray-500\">No categories yet</div>';\n          return;\n        }\n\n        table.innerHTML = categories.map(cat => `\n          <div class=\"p-6 hover:bg-gray-50\" data-id=\"${cat.id}\">\n            <div class=\"flex items-center justify-between\">\n              <div class=\"flex-1\">\n                <div class=\"edit-view-${cat.id}\">\n                  <h3 class=\"font-medium text-gray-900\">${cat.name}</h3>\n                  <p class=\"text-sm text-gray-500 mt-1\">${cat.slug}</p>\n                </div>\n                <div class=\"edit-form-${cat.id} hidden\">\n                  <div class=\"flex gap-4\">\n                    <input \n                      type=\"text\" \n                      class=\"edit-name flex-1 px-3 py-2 border border-gray-300 rounded-lg\"\n                      value=\"${cat.name}\"\n                    />\n                    <input \n                      type=\"text\" \n                      class=\"edit-slug flex-1 px-3 py-2 border border-gray-300 rounded-lg\"\n                      value=\"${cat.slug}\"\n                    />\n                  </div>\n                </div>\n              </div>\n              <div class=\"flex gap-2\">\n                <div class=\"edit-actions-${cat.id}\">\n                  <button class=\"edit-btn px-3 py-1 text-sm text-blue-600 hover:text-blue-800\" data-id=\"${cat.id}\">Edit</button>\n                  <button class=\"delete-btn px-3 py-1 text-sm text-red-600 hover:text-red-800\" data-id=\"${cat.id}\">Delete</button>\n                </div>\n                <div class=\"save-actions-${cat.id} hidden\">\n                  <button class=\"save-btn px-3 py-1 text-sm text-green-600 hover:text-green-800\" data-id=\"${cat.id}\">Save</button>\n                  <button class=\"cancel-btn px-3 py-1 text-sm text-gray-600 hover:text-gray-800\" data-id=\"${cat.id}\">Cancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        `).join('');\n\n        attachEventHandlers();\n      }\n\n      function attachEventHandlers() {\n        // Edit buttons\n        document.querySelectorAll('.edit-btn').forEach(btn => {\n          btn.addEventListener('click', (e) => {\n            const id = e.target.dataset.id;\n            document.querySelector(`.edit-view-${id}`).classList.add('hidden');\n            document.querySelector(`.edit-form-${id}`).classList.remove('hidden');\n            document.querySelector(`.edit-actions-${id}`).classList.add('hidden');\n            document.querySelector(`.save-actions-${id}`).classList.remove('hidden');\n          });\n        });\n\n        // Cancel buttons\n        document.querySelectorAll('.cancel-btn').forEach(btn => {\n          btn.addEventListener('click', (e) => {\n            const id = e.target.dataset.id;\n            document.querySelector(`.edit-view-${id}`).classList.remove('hidden');\n            document.querySelector(`.edit-form-${id}`).classList.add('hidden');\n            document.querySelector(`.edit-actions-${id}`).classList.remove('hidden');\n            document.querySelector(`.save-actions-${id}`).classList.add('hidden');\n          });\n        });\n\n        // Save buttons\n        document.querySelectorAll('.save-btn').forEach(btn => {\n          btn.addEventListener('click', async (e) => {\n            const id = e.target.dataset.id;\n            const name = document.querySelector(`.edit-form-${id} .edit-name`).value;\n            const slug = document.querySelector(`.edit-form-${id} .edit-slug`).value;\n\n            try {\n              await fetch(`${API_BASE}/admin/categories/${id}`, {\n                method: 'PATCH',\n                headers: {\n                  'Content-Type': 'application/json',\n                  Authorization: `Bearer ${token}`\n                },\n                body: JSON.stringify({ name, slug })\n              });\n              await loadCategories();\n            } catch (err) {\n              alert('Failed to update category');\n            }\n          });\n        });\n\n        // Delete buttons\n        document.querySelectorAll('.delete-btn').forEach(btn => {\n          btn.addEventListener('click', async (e) => {\n            const id = e.target.dataset.id;\n            if (!confirm('Are you sure you want to delete this category?')) return;\n            \n            try {\n              await fetch(`${API_BASE}/admin/categories/${id}`, {\n                method: 'DELETE',\n                headers: { Authorization: `Bearer ${token}` }\n              });\n              await loadCategories();\n            } catch (err) {\n              alert('Failed to delete category');\n            }\n          });\n        });\n      }\n\n      // Create form\n      document.getElementById('createForm').addEventListener('submit', async (e) => {\n        e.preventDefault();\n        \n        const name = document.getElementById('newName').value;\n        const slug = document.getElementById('newSlug').value;\n\n        try {\n          await fetch(`${API_BASE}/admin/categories`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: `Bearer ${token}`\n            },\n            body: JSON.stringify({ name, slug })\n          });\n          \n          document.getElementById('newName').value = '';\n          document.getElementById('newSlug').value = '';\n          await loadCategories();\n        } catch (err) {\n          alert('Failed to create category');\n        }\n      });\n\n      // Auto-generate slug from name\n      document.getElementById('newName').addEventListener('input', (e) => {\n        const slug = e.target.value.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');\n        document.getElementById('newSlug').value = slug;\n      });\n\n      await loadCategories();\n    })();\n  })();</script> "], [" ", '<div> <h1 class="text-3xl font-bold text-gray-900 mb-8">Categories</h1> <!-- Create new category form --> <div class="bg-white rounded-lg shadow p-6 mb-6"> <h2 class="text-lg font-semibold text-gray-900 mb-4">Add New Category</h2> <form id="createForm" class="flex gap-4"> <div class="flex-1"> <input type="text" id="newName" placeholder="Category name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"> </div> <div class="flex-1"> <input type="text" id="newSlug" placeholder="slug-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"> </div> <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">\nAdd Category\n</button> </form> </div> <!-- Categories list --> <div class="bg-white rounded-lg shadow"> <div class="p-6 border-b border-gray-200"> <h2 class="text-lg font-semibold text-gray-900">All Categories</h2> </div> <div id="categoriesTable" class="divide-y divide-gray-200"> <div class="p-6 text-gray-500">Loading...</div> </div> </div> </div> <script>(function(){', "\n    (async function(){\n      const getToken = () => {\n        try { const t = localStorage.getItem('token'); if (t) return t; } catch(e) {}\n        const m = document.cookie.match(/(?:^|; )token=([^;]+)/);\n        if (m) return decodeURIComponent(m[1]);\n        return null;\n      };\n\n      const token = getToken();\n      if (!token) return;\n\n      let categories = [];\n      let editingId = null;\n\n      async function loadCategories() {\n        try {\n          const res = await fetch(\\`\\${API_BASE}/admin/categories\\`, {\n            headers: { Authorization: \\`Bearer \\${token}\\` }\n          });\n          categories = await res.json();\n          renderCategories();\n        } catch (err) {\n          console.error('Failed to load categories', err);\n          document.getElementById('categoriesTable').innerHTML = '<div class=\"p-6 text-red-500\">Failed to load categories</div>';\n        }\n      }\n\n      function renderCategories() {\n        const table = document.getElementById('categoriesTable');\n        if (categories.length === 0) {\n          table.innerHTML = '<div class=\"p-6 text-gray-500\">No categories yet</div>';\n          return;\n        }\n\n        table.innerHTML = categories.map(cat => \\`\n          <div class=\"p-6 hover:bg-gray-50\" data-id=\"\\${cat.id}\">\n            <div class=\"flex items-center justify-between\">\n              <div class=\"flex-1\">\n                <div class=\"edit-view-\\${cat.id}\">\n                  <h3 class=\"font-medium text-gray-900\">\\${cat.name}</h3>\n                  <p class=\"text-sm text-gray-500 mt-1\">\\${cat.slug}</p>\n                </div>\n                <div class=\"edit-form-\\${cat.id} hidden\">\n                  <div class=\"flex gap-4\">\n                    <input \n                      type=\"text\" \n                      class=\"edit-name flex-1 px-3 py-2 border border-gray-300 rounded-lg\"\n                      value=\"\\${cat.name}\"\n                    />\n                    <input \n                      type=\"text\" \n                      class=\"edit-slug flex-1 px-3 py-2 border border-gray-300 rounded-lg\"\n                      value=\"\\${cat.slug}\"\n                    />\n                  </div>\n                </div>\n              </div>\n              <div class=\"flex gap-2\">\n                <div class=\"edit-actions-\\${cat.id}\">\n                  <button class=\"edit-btn px-3 py-1 text-sm text-blue-600 hover:text-blue-800\" data-id=\"\\${cat.id}\">Edit</button>\n                  <button class=\"delete-btn px-3 py-1 text-sm text-red-600 hover:text-red-800\" data-id=\"\\${cat.id}\">Delete</button>\n                </div>\n                <div class=\"save-actions-\\${cat.id} hidden\">\n                  <button class=\"save-btn px-3 py-1 text-sm text-green-600 hover:text-green-800\" data-id=\"\\${cat.id}\">Save</button>\n                  <button class=\"cancel-btn px-3 py-1 text-sm text-gray-600 hover:text-gray-800\" data-id=\"\\${cat.id}\">Cancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        \\`).join('');\n\n        attachEventHandlers();\n      }\n\n      function attachEventHandlers() {\n        // Edit buttons\n        document.querySelectorAll('.edit-btn').forEach(btn => {\n          btn.addEventListener('click', (e) => {\n            const id = e.target.dataset.id;\n            document.querySelector(\\`.edit-view-\\${id}\\`).classList.add('hidden');\n            document.querySelector(\\`.edit-form-\\${id}\\`).classList.remove('hidden');\n            document.querySelector(\\`.edit-actions-\\${id}\\`).classList.add('hidden');\n            document.querySelector(\\`.save-actions-\\${id}\\`).classList.remove('hidden');\n          });\n        });\n\n        // Cancel buttons\n        document.querySelectorAll('.cancel-btn').forEach(btn => {\n          btn.addEventListener('click', (e) => {\n            const id = e.target.dataset.id;\n            document.querySelector(\\`.edit-view-\\${id}\\`).classList.remove('hidden');\n            document.querySelector(\\`.edit-form-\\${id}\\`).classList.add('hidden');\n            document.querySelector(\\`.edit-actions-\\${id}\\`).classList.remove('hidden');\n            document.querySelector(\\`.save-actions-\\${id}\\`).classList.add('hidden');\n          });\n        });\n\n        // Save buttons\n        document.querySelectorAll('.save-btn').forEach(btn => {\n          btn.addEventListener('click', async (e) => {\n            const id = e.target.dataset.id;\n            const name = document.querySelector(\\`.edit-form-\\${id} .edit-name\\`).value;\n            const slug = document.querySelector(\\`.edit-form-\\${id} .edit-slug\\`).value;\n\n            try {\n              await fetch(\\`\\${API_BASE}/admin/categories/\\${id}\\`, {\n                method: 'PATCH',\n                headers: {\n                  'Content-Type': 'application/json',\n                  Authorization: \\`Bearer \\${token}\\`\n                },\n                body: JSON.stringify({ name, slug })\n              });\n              await loadCategories();\n            } catch (err) {\n              alert('Failed to update category');\n            }\n          });\n        });\n\n        // Delete buttons\n        document.querySelectorAll('.delete-btn').forEach(btn => {\n          btn.addEventListener('click', async (e) => {\n            const id = e.target.dataset.id;\n            if (!confirm('Are you sure you want to delete this category?')) return;\n            \n            try {\n              await fetch(\\`\\${API_BASE}/admin/categories/\\${id}\\`, {\n                method: 'DELETE',\n                headers: { Authorization: \\`Bearer \\${token}\\` }\n              });\n              await loadCategories();\n            } catch (err) {\n              alert('Failed to delete category');\n            }\n          });\n        });\n      }\n\n      // Create form\n      document.getElementById('createForm').addEventListener('submit', async (e) => {\n        e.preventDefault();\n        \n        const name = document.getElementById('newName').value;\n        const slug = document.getElementById('newSlug').value;\n\n        try {\n          await fetch(\\`\\${API_BASE}/admin/categories\\`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: \\`Bearer \\${token}\\`\n            },\n            body: JSON.stringify({ name, slug })\n          });\n          \n          document.getElementById('newName').value = '';\n          document.getElementById('newSlug').value = '';\n          await loadCategories();\n        } catch (err) {\n          alert('Failed to create category');\n        }\n      });\n\n      // Auto-generate slug from name\n      document.getElementById('newName').addEventListener('input', (e) => {\n        const slug = e.target.value.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');\n        document.getElementById('newSlug').value = slug;\n      });\n\n      await loadCategories();\n    })();\n  })();</script> "])), maybeRenderHead(), defineScriptVars({ API_BASE })) })}`;
}, "/home/dave/Documents/devnewsletter/newsletter/src/pages/admin/categories/index.astro", void 0);
const $$file = "/home/dave/Documents/devnewsletter/newsletter/src/pages/admin/categories/index.astro";
const $$url = "/admin/categories";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
